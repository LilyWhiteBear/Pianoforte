<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pianoforte</title>
    <script src="js/pixi.min.js"></script>
    <script src="js/pixi-sound.js"></script>
    <script src="js/gameFunction/script.js"></script>
    <script src="js/gameFunction/ticker.js"></script>
    <script>
        let app;
        let keys = {};
        let speed = 8;
        let volumn = 10;
        let ticker_count = 0;
        let foschan_ticker = 0;
        let isEnd = false;
        var startTime;
        var timeDistance = 0;
        var windowHeight = window.screen.height;
        var windowWidth = window.screen.width;
        var appHeight;
        var appWidth;
        var playTime = 1;

        var cheatMode = false;

        var songDict = [{
            name: 'POWER SPOT',
            path: 'sounds/POWER_SPOT!!.ogg',
            time: "3:57",
        },
        {
            name: 'MIRACLE WAVE',
            path: 'sounds/MIRACLE_WAVE.ogg',
            time: "4:12",
        },
        {
            name: 'VIVID WORLD',
            path: 'sounds/VIVID WORLD (short ver.).mp3',
            time: "1:38",
        },
        {
            name: 'START DASH',
            path: 'sounds/Start-Dash!!.ogg',
            time: "4:17",
        },
        {
            name: 'ANGELIC ANGEL',
            path: 'sounds/Angelic_Angel.mp3',
            time: "1:49",
        },
        {
            name: 'PURE PHRASE',
            path: 'sounds/09._PURE_PHRASE.ogg',
            time: "5:10",
        }]

        let comboText;
        let scoreText;
        let playing_accuracyText;
        let hitTextS;
        let hitTextD;
        let hitTextK;
        let hitTextL;

        let foschan1;
        let foschan2;

        let textureSButton;
        let textureDButton;
        let textureKButton;
        let textureLButton;
        let texture_pressedSButton;
        let texture_pressedDButton;
        let texture_pressedKButton;
        let texture_pressedLButton;
        let SButton;
        let DButton;
        let KButton;
        let LButton;
        let noteS;
        let noteD;
        let noteK;
        let noteL;

        let noteS_start;
        let noteS_sign;
        let noteS_body;
        let noteS_end;
        let noteS_sign_end;
        let noteD_start;
        let noteD_sign;
        let noteD_body;
        let noteD_end;
        let noteD_sign_end;
        let noteK_start;
        let noteK_sign;
        let noteK_body;
        let noteK_end;
        let noteK_sign_end;
        let noteL_start;
        let noteL_sign;
        let noteL_body;
        let noteL_end;
        let noteL_sign_end;
        let noteType = [0, 0, 0, 0];
        let noteAvailiable = [false, false, false, false];
        let performanceGraph;
        let perfromanceGraphProp = {
            x: 0,
            y: 0,
            height: 0,
            width: 0
        }

        let combo = 0;
        let score = 0;
        let maxCombo = 0;
        let note_num = 0;
        let performancePlay = [];
        let perfectTap = 0;
        let goodTap = 0;
        let badTap = 0;
        let missTap = 0;
        let accuracy = 0;
        let accuracy_score = 0;
        let candleArray = [];

        let rainbowGradient = [
            "#b00b0b",
            "#cf601d",
            "#eef30a",
            "#0c7e39",
            "#1ea2b0",
            "#0404bd",
            "#6f136c"
        ];

        const Headerstyle = new PIXI.TextStyle({
            fontSize: 50,
            fontWeight: "bolder"
        });

        let top_layer;
        let ground_layer;

        if (windowHeight >= 1000 && windowWidth >= 500) {
            appHeight = 800;
            appWidth = 400;
        }
        else if (windowHeight >= 1000 && windowWidth < 500) {
            appHeight = windowWidth * 1.6;
            appWidth = windowWidth * 0.8;
        }
        else if (windowHeight < 1000 && windowWidth >= 500) {
            appHeight = windowHeight * 0.8;
            appWidth = windowHeight * 0.4;
        }
        else {
            appHeight = windowHeight * 0.8;
            appWidth = windowWidth * 0.8;
        }

        var appX = windowWidth / 2 - (appWidth / 2);
        var appY = windowHeight / 2 - (appHeight / 2);

        perfromanceGraphProp.x = appX + appWidth * 0.2;
        perfromanceGraphProp.y = appY + appHeight * 0.5;
        perfromanceGraphProp.width = appWidth * 0.7;
        perfromanceGraphProp.height = appHeight * 0.2;

        window.onload = function () {
            app = new PIXI.Application(
                {
                    // width: appWidth,
                    // height: appHeight,
                    resizeTo: window,
                    backgroundColor: 0xffffff
                }
            );
            document.body.appendChild(app.view);

            background = new PIXI.Graphics();
            background.beginFill(0xAAAAAA);
            background.drawRect(appX, appY, appWidth, appHeight);
            app.stage.addChild(background);

            titleScreen = new PIXI.Container();
            songSelectScreen = new PIXI.Container();
            playScreen = new PIXI.Container();
            resultScreen = new PIXI.Container();

            app.stage.addChild(titleScreen);
            app.stage.addChild(songSelectScreen);
            app.stage.addChild(playScreen);
            app.stage.addChild(resultScreen);

            titleScreen.visible = true;
            songSelectScreen.visible = false;
            playScreen.visible = false;
            resultScreen.visible = false;

            let ticker_fos = new PIXI.Ticker();
            ticker_fos.autoStart = true;
            ticker_fos.add(foschanLoop);

            let ticker = new PIXI.Ticker();
            ticker.autoStart = false;
            ticker.add(gameLoop);

            //title screen 
            let titleText = new PIXI.Text("Pianoforte");
            adjObj(titleText, titleScreen, appX + (appWidth * 0.5), appY + (appHeight * 0.15), false, 0.5);

            foschan1 = new PIXI.Sprite.from("images/foschan1.png");
            adjSprite(foschan1, titleScreen, appX + appWidth * 0.5, appY + appHeight * 0.5, appWidth * 0.6, appHeight * 0.5, false, 0.5);

            foschan2 = new PIXI.Sprite.from("images/foschan2.png");
            adjSprite(foschan2, titleScreen, appX + appWidth * 0.5, appY + appHeight * 0.5, appWidth * 0.6, appHeight * 0.5, false, 0.5);
            foschan2.visible = false;

            let startButton = new PIXI.Sprite.from("images/button.png");
            adjSprite(startButton, titleScreen, appX + appWidth * 0.5, appY + appHeight * 0.85, appWidth * 0.3, appHeight * 0.1, true, 0.5);
            startButton.on('pointerdown', function () {
                titleScreen.visible = false;
                songSelectScreen.visible = true;
            });
            titleScreen.addChild(startButton);

            //song select screen
            let songSelectText = new PIXI.Text("Select song");
            adjObj(songSelectText, songSelectScreen, appX + appWidth * 0.25, appY + appHeight * 0.05, false, 0.5);

            let settingButton = new PIXI.Sprite.from("images/setting_button.png");
            adjSprite(settingButton, songSelectScreen, appX + appWidth * 0.85, appY + appHeight * 0.05, appWidth * 0.15, appWidth * 0.15, true, 0.5);
            settingButton.on('pointerdown', function () {
                songSelectScreen.visible = false;

                let settingContainer = new PIXI.Container();
                app.stage.addChild(settingContainer);
                settingContainer.visible = true;

                let settingText = new PIXI.Text("Setting", Headerstyle);
                adjObj(settingText, settingContainer, appX + appWidth * 0.05, appY + appHeight * 0.025, false);

                let settingClose = new PIXI.Text("X", Headerstyle);
                adjObj(settingClose, settingContainer, appX + appWidth * 0.85, appY + appHeight * 0.025, true);
                settingClose.on('pointerdown', function () {
                    settingContainer.visible = false;
                    songSelectScreen.visible = true;
                });

                let volumnText = new PIXI.Text("Volumn");
                adjObj(volumnText, settingContainer, appX + appWidth * 0.05, appY + appHeight * 0.15, false);

                let volumnDecrease = new PIXI.Text("-");
                adjObj(volumnDecrease, settingContainer, appX + appWidth * 0.6, appY + appHeight * 0.15, true);
                volumnDecrease.on('pointerdown', function () {
                    if (volumn >= 5) {
                        volumn -= 5;
                        volumnModify.text = volumn;
                        let testSound = new PIXI.sound.Sound.from({
                            url: 'sounds/poi.mp3',
                            autoPlay: true,
                            volume: volumn / 100,
                        });
                    }
                });

                let volumnIncrease = new PIXI.Text("+");
                adjObj(volumnIncrease, settingContainer, appX + appWidth * 0.8, appY + appHeight * 0.15, true);
                volumnIncrease.on('pointerdown', function () {
                    if (volumn <= 95) {
                        volumn += 5;
                        volumnModify.text = volumn;
                        let testSound = new PIXI.sound.Sound.from({
                            url: 'sounds/poi.mp3',
                            autoPlay: true,
                            volume: volumn / 100,
                        });
                    }
                });

                let volumnModify = new PIXI.Text(volumn);
                adjObj(volumnModify, settingContainer, appX + appWidth * 0.72, appY + appHeight * 0.17, false, 0.5);

                let speedText = new PIXI.Text("NoteSpeed");
                adjObj(speedText, settingContainer, appX + appWidth * 0.05, appY + appHeight * 0.25, false);

                let speedDecrease = new PIXI.Text("-");
                adjObj(speedDecrease, settingContainer, appX + appWidth * 0.6, appY + appHeight * 0.25, true);
                speedDecrease.on('pointerdown', function () {
                    if (speed > 4) {
                        speed--;
                        speedModify.text = speed;
                        rankTextModify();
                    }
                });

                let speedIncrease = new PIXI.Text("+");
                adjObj(speedIncrease, settingContainer, appX + appWidth * 0.8, appY + appHeight * 0.25, true);
                speedIncrease.on('pointerdown', function () {
                    if (speed < 20) {
                        speed++;
                        speedModify.text = speed;
                        rankTextModify();
                    }
                });

                let speedModify = new PIXI.Text(speed);
                adjObj(speedModify, settingContainer, appX + appWidth * 0.72, appY + appHeight * 0.27, false, 0.5);

                let rankDesc = new PIXI.Text("Difficulty");
                adjObj(rankDesc, settingContainer, appX + appWidth * 0.05, appY + appHeight * 0.35, false);

                let rankText = new PIXI.Text("");
                rankText.style.fontWeight = "bold";
                adjObj(rankText, settingContainer, appX + appWidth * 0.72, appY + appHeight * 0.37, false, 0.5);
                rankTextModify();

                function rankTextModify() {
                    if (speed >= 15) {
                        rankText.style.fill = 0xda0000;
                        rankText.text = "MASTER"
                    }
                    else if (speed >= 12) {
                        rankText.style.fill = 0xFF5733;
                        rankText.text = "HARD"
                    }
                    else if (speed >= 8) {
                        rankText.style.fill = 0xFFC300;
                        rankText.text = "NORMAL"
                    }
                    else {
                        rankText.style.fill = 0x006d33;
                        rankText.text = "EASY"
                    }
                }

            });

            let songContainer = new PIXI.Container();
            songSelectScreen.addChild(songContainer);

            for (let i in songDict) {
                let songButton = new PIXI.Container();
                songSelectScreen.addChild(songButton);

                let songButtonBG = new PIXI.Graphics();
                if (i % 2 === 0) songButtonBG.beginFill(0xeaeaea);
                else songButtonBG.beginFill(0xc6e2ff);
                songButtonBG.drawRect(appX, appY + appHeight * 0.1 + (i * 0.05 * appHeight), appWidth, appHeight * 0.05);
                songButton.addChild(songButtonBG);

                let songName = new PIXI.Text(songDict[i].name);
                adjObj(songName, songButton, appX + appWidth * 0.4, appY + appHeight * 0.125 + (i * 0.05 * appHeight), false, 0.5);

                let songTime = new PIXI.Text(songDict[i].time);
                adjObj(songTime, songButton, appX + appWidth * 0.9, appY + appHeight * 0.125 + (i * 0.05 * appHeight), false, 0.5);

                songButton.interactive = true;
                songButton.buttonMode = true;
                songButton.on('pointerdown', function () {

                    interactiveSwitch(songSelectScreen, false);

                    let confirmSpeedScreen = new PIXI.Container();
                    songSelectScreen.addChild(confirmSpeedScreen);

                    let csBG = new PIXI.Graphics();
                    csBG.beginFill(0xffffff);
                    csBG.drawRect(appX + appWidth * 0.1, appY + appHeight * 0.3, appWidth * 0.8, appHeight * 0.4);
                    confirmSpeedScreen.addChild(csBG);

                    let csClose = new PIXI.Text("X", Headerstyle);
                    adjObj(csClose, confirmSpeedScreen, appX + appWidth * 0.8, appY + appHeight * 0.3, true);
                    csClose.on('pointerdown', function () {
                        songSelectScreen.removeChild(confirmSpeedScreen);
                        interactiveSwitch(songSelectScreen, true);
                    });

                    let speedTextConfirm = new PIXI.Text("NoteSpeed");
                    adjObj(speedTextConfirm, confirmSpeedScreen, appX + appWidth * 0.15, appY + appHeight * 0.45, false);

                    let speedDecreaseConfirm = new PIXI.Text("-");
                    adjObj(speedDecreaseConfirm, confirmSpeedScreen, appX + appWidth * 0.6, appY + appHeight * 0.45, true);
                    speedDecreaseConfirm.on('pointerdown', function () {
                        if (speed > 4) {
                            speed--;
                            speedModifyConfirm.text = speed;
                            rankTextModify();
                        }
                    });

                    let speedIncreaseConfirm = new PIXI.Text("+");
                    adjObj(speedIncreaseConfirm, confirmSpeedScreen, appX + appWidth * 0.8, appY + appHeight * 0.45, true);
                    speedIncreaseConfirm.on('pointerdown', function () {
                        if (speed < 20) {
                            speed++;
                            speedModifyConfirm.text = speed;
                            rankTextModify();
                        }
                    });

                    let speedModifyConfirm = new PIXI.Text(speed);
                    adjObj(speedModifyConfirm, confirmSpeedScreen, appX + appWidth * 0.72, appY + appHeight * 0.47, true, 0.5);

                    let playButtonAC = new PIXI.Sprite.from("/images/button.png");
                    adjObj(playButtonAC, confirmSpeedScreen, appX + appWidth * 0.5, appY + appHeight * 0.6, true, 0.5);
                    playButtonAC.on('pointerdown', function () {
                        songSelectScreen.removeChild(playButtonAC);
                        songSelectScreen.removeChild(confirmSpeedScreen);
                        songSelectScreen.visible = false;
                        playScreen.visible = true;
                        scoreText.text = "0";
                        comboText.text = "0 combos";
                        playing_accuracyText.text = "0%"
                        startTime = new Date().getTime();
                        timeDistance = songDict[i] * 1000;
                        accuracy_score = 0;
                        score = 0;
                        combo = 0;
                        maxCombo = 0;
                        ticker_count = 0;
                        note_num = 0;
                        perfectTap = 0;
                        goodTap = 0;
                        badTap = 0;
                        missTap = 0;
                        playTime--;
                        performancePlay = [];
                        while (candleArray.length > 0) {
                            resultScreen.removeChild(candleArray[0]);
                            candleArray.shift();
                        }
                        ticker.start();
                        //song
                        let song = new PIXI.sound.Sound.from({
                            url: songDict[i].path,
                            autoPlay: true,
                            volume: volumn / 10,
                            complete: function () {
                                isEnd = true;
                                setTimeout(function () {
                                    if (combo === note_num) perfectText.visible = true;
                                    ticker.stop();
                                }, 5000);
                                setTimeout(function () {
                                    isEnd = false;
                                    songText.text = songDict[i].name;

                                    if (accuracy === 100) gradeText.text = "SSS";
                                    else if (accuracy >= 95) gradeText.text = "SS";
                                    else if (accuracy >= 90) gradeText.text = "S";
                                    else if (accuracy >= 85) gradeText.text = "A";
                                    else if (accuracy >= 80) gradeText.text = "B";
                                    else if (accuracy >= 70) gradeText.text = "C";
                                    else if (accuracy >= 50) gradeText.text = "D";
                                    else gradeText.text = "F";
                                    accuracyText.text = "accuracy " + accuracy + "%";
                                    maxComboText.text = "Max Combo : " + maxCombo + "combo";
                                    resultScoreText.text = "score : " + score;
                                    perfectTapText.text = perfectTap + " perfect";
                                    goodTapText.text = goodTap + " good";
                                    badTapText.text = badTap + " bad";
                                    missTapText.text = missTap + " miss";
                                    perfectText.visible = false;
                                    playScreen.visible = false;
                                    resultScreen.visible = true;
                                    let graphX = perfromanceGraphProp.x;
                                    let graphY = perfromanceGraphProp.y;
                                    let graphWidth = perfromanceGraphProp.width;
                                    let graphHeight = perfromanceGraphProp.height;
                                    for (let i in performancePlay) {
                                        let candle = new PIXI.Graphics();
                                        if (i != 0 && performancePlay[i] < performancePlay[i - 1])
                                            candle.beginFill(0xDC143C);
                                        else candle.beginFill(0x1ca700);
                                        let drawX = graphX + (((i + 1) / note_num) / 10 * graphWidth);
                                        let drawY = graphY + ((3 - performancePlay[i]) / 4) * graphHeight;
                                        candle.drawRect(drawX, drawY, graphWidth / note_num, graphHeight / 4);
                                        resultScreen.addChild(candle);
                                        candleArray.push(candle);
                                    }
                                }, 8000);
                            }
                        });
                    })

                });
            }


            //play screen
            textureSButton = PIXI.Texture.from("images/S.png");
            textureDButton = PIXI.Texture.from("images/D.png");
            textureKButton = PIXI.Texture.from("images/K.png");
            textureLButton = PIXI.Texture.from("images/L.png");

            texture_pressedSButton = PIXI.Texture.from("images/S_pressed.png");
            texture_pressedDButton = PIXI.Texture.from("images/D_pressed.png");
            texture_pressedKButton = PIXI.Texture.from("images/K_pressed.png");
            texture_pressedLButton = PIXI.Texture.from("images/L_pressed.png");

            SButton = new PIXI.Sprite(textureSButton);
            adjSprite(SButton, playScreen, appX + appWidth * 0.125, appY + appHeight * 0.925, appWidth * 0.25, appHeight * 0.15, true, 0.5);
            SButton.on('pointerdown', function () {
                keys['83'] = true;
            });
            SButton.on('pointerup', function () {
                keys['83'] = false;
            });
            SButton.on('pointerout', function () {
                keys['83'] = false;
            });

            DButton = new PIXI.Sprite(textureDButton);
            adjSprite(DButton, playScreen, appX + appWidth * 0.375, appY + appHeight * 0.925, appWidth * 0.25, appHeight * 0.15, true, 0.5);
            DButton.on('pointerdown', function () {
                keys['68'] = true;
            });
            DButton.on('pointerup', function () {
                keys['68'] = false;
            });
            DButton.on('pointerout', function () {
                keys['68'] = false;
            });

            KButton = new PIXI.Sprite(textureKButton);
            adjSprite(KButton, playScreen, appX + appWidth * 0.625, appY + appHeight * 0.925, appWidth * 0.25, appHeight * 0.15, true, 0.5);
            KButton.on('pointerdown', function () {
                keys['75'] = true;
            });
            KButton.on('pointerup', function () {
                keys['75'] = false;
            });
            KButton.on('pointerout', function () {
                keys['75'] = false;
            });

            LButton = new PIXI.Sprite(textureLButton);
            adjSprite(LButton, playScreen, appX + appWidth * 0.875, appY + appHeight * 0.925, appWidth * 0.25, appHeight * 0.15, true, 0.5);
            LButton.on('pointerdown', function () {
                keys['76'] = true;
            });
            LButton.on('pointerup', function () {
                keys['76'] = false;
            });
            LButton.on('pointerout', function () {
                keys['76'] = false;
            });

            scoreText = new PIXI.Text("0");
            adjObj(scoreText, playScreen, appX + appWidth * 0.5, appY + appHeight * 0.2, false, 0.5);

            comboText = new PIXI.Text("0 combos");
            adjObj(comboText, playScreen, appX + appWidth * 0.5, appY + appHeight * 0.25, false, 0.5);

            playing_accuracyText = new PIXI.Text("0%");
            adjObj(playing_accuracyText, playScreen, appX + appWidth * 0.75, appY + appHeight * 0.05, false);

            hitTextS = new PIXI.Text();
            adjObj(hitTextS, playScreen, appX + appWidth * 0.125, appY + appHeight * 0.55, false, 0.5);

            hitTextD = new PIXI.Text();
            adjObj(hitTextD, playScreen, appX + appWidth * 0.375, appY + appHeight * 0.55, false, 0.5);

            hitTextK = new PIXI.Text();
            adjObj(hitTextK, playScreen, appX + appWidth * 0.625, appY + appHeight * 0.55, false, 0.5);

            hitTextL = new PIXI.Text();
            adjObj(hitTextL, playScreen, appX + appWidth * 0.875, appY + appHeight * 0.55, false, 0.5);

            perfectText = new PIXI.Text("PERFECT COMBO!!!");
            adjObj(perfectText, playScreen, appX + appWidth * 0.5, appY + appHeight * 0.3, false, 0.5);
            perfectText.style.fontSize = 30;

            hitTextS.visible = false;
            hitTextD.visible = false;
            hitTextK.visible = false;
            hitTextL.visible = false;
            perfectText.visible = false;

            //result screen

            let songText = new PIXI.Text("untiltled");
            songText.fontWeight = "bold";
            adjObj(songText, resultScreen, appX + appWidth * 0.1, appY + appHeight * 0.05, false);

            let accuracyText = new PIXI.Text("accuracy 0%");
            adjObj(accuracyText, resultScreen, appX + appWidth * 0.1, appY + appHeight * 0.1, false);

            let gradeTextStyle = new PIXI.TextStyle({
                fill: rainbowGradient,
                fillGradientType: 1,
                fontFamily: "Comic Sans MS",
                fontSize: 50,
                fontWeight: "bold"
            });

            let gradeText = new PIXI.Text("F", gradeTextStyle);
            adjObj(gradeText, resultScreen, appX + appWidth * 0.8, appY + appHeight * 0.1, false, 0.5);

            let maxComboText = new PIXI.Text("0 combos");
            adjObj(maxComboText, resultScreen, appX + appWidth * 0.5, appY + appHeight * 0.25, false, 0.5);

            let resultScoreText = new PIXI.Text(score);
            adjObj(resultScoreText, resultScreen, appX + appWidth * 0.5, appY + appHeight * 0.2, false, 0.5);

            let perfectTapText = new PIXI.Text("perfect");
            adjObj(perfectTapText, resultScreen, appX + appWidth * 0.1, appY + appHeight * 0.3, false);

            let goodTapText = new PIXI.Text("good");
            adjObj(goodTapText, resultScreen, appX + appWidth * 0.6, appY + appHeight * 0.3, false);

            let badTapText = new PIXI.Text("bad");
            adjObj(badTapText, resultScreen, appX + appWidth * 0.1, appY + appHeight * 0.35, false);

            let missTapText = new PIXI.Text("miss");
            adjObj(missTapText, resultScreen, appX + appWidth * 0.6, appY + appHeight * 0.35, false);

            let performanceText = new PIXI.Text("Performance Graph");
            adjObj(performanceText, resultScreen, appX + appWidth * 0.1, perfromanceGraphProp.y - (appHeight * 0.1), false);

            performanceGraph = new PIXI.Graphics();
            performanceGraph.beginFill(0xFFFFFF);
            performanceGraph.drawRect(perfromanceGraphProp.x, perfromanceGraphProp.y, perfromanceGraphProp.width, perfromanceGraphProp.height);
            resultScreen.addChild(performanceGraph);

            let perfectPText = new PIXI.Text("PERFECT");
            adjObj(perfectPText, resultScreen, appX + appWidth * 0.1, perfromanceGraphProp.y + (perfromanceGraphProp.height / 5), false, 0.5);
            perfectPText.style.fontSize = 8;

            let goodText = new PIXI.Text("GOOD");
            adjObj(goodText, resultScreen, appX + appWidth * 0.1, perfromanceGraphProp.y + (perfromanceGraphProp.height * 2 / 5), false, 0.5);
            goodText.style.fontSize = 8;

            let badText = new PIXI.Text("BAD");
            adjObj(badText, resultScreen, appX + appWidth * 0.1, perfromanceGraphProp.y + (perfromanceGraphProp.height * 3 / 5), false, 0.5);
            badText.style.fontSize = 8;

            let missText = new PIXI.Text("MISS");
            adjObj(missText, resultScreen, appX + appWidth * 0.1, perfromanceGraphProp.y + (perfromanceGraphProp.height * 4 / 5), false, 0.5);          
            missText.style.fontSize = 8;

            let restartButton = new PIXI.Sprite.from("images/button.png");
            adjSprite(restartButton, resultScreen, appX + appWidth * 0.5, appY + appHeight * 0.9, appWidth * 0.3, appHeight * 0.1, true, 0.5);
            restartButton.on('pointerdown', function () {
                resultScreen.visible = false;
                titleScreen.visible = true;
                if (playTime <= 0) startButton.enable = false;
            });

            //invisible layer
            top_layer = new PIXI.Graphics();
            top_layer.beginFill(0xffffff);
            top_layer.drawRect(0, 0, windowWidth, appY);
            playScreen.addChild(top_layer);

            ground_layer = new PIXI.Graphics();
            ground_layer.beginFill(0xffffff);
            ground_layer.drawRect(0, appY + appHeight, windowWidth, windowHeight - appY - appHeight);
            playScreen.addChild(ground_layer);


            for (let i = 1; i <= 3; i++) {
                let seperater = new PIXI.Graphics();
                seperater.beginFill(0xC70039);
                seperater.drawRect(appX + appWidth * 0.25 * i, appY, 1, appHeight);
                playScreen.addChild(seperater);
            }

            //keyboard event handler
            window.addEventListener("keydown", keysDown);
            window.addEventListener("keyup", keysUp);

        }
    </script>
</head>